<div class="movements-view">
  <div class="ibox">
    <div class="ibox-title">
      <h3>
        <%= htmlWebpackPlugin.options.costing.ov_movements %>
      </h3>
    </div>
    <div class="ibox-content">
      <button 
          ng-repeat="type in types" 
          class="btn" 
          ng-class="(type.value == selectedType)? 'btn-today' : 'btn-secondary-left'" 
          ng-click="typeChange(type.value)">
        {{type.label}}
      </button>
      <a 
          class="btn btn-success" 
          href="{{downloadLink}}" 
          ng-hide="isEmpty" 
          download="Movimientos.xlsx">
        <%= htmlWebpackPlugin.options.general.download %>
      </a>

      <br>
      <br>
      
      <p class="input-group pull-left" style="width: 25%; margin-right: 1rem;">
        <span class="input-group-btn">
          <button 
              type="button" 
              class="btn btn-calendar" 
              ng-click="openStartDate()">
            <%= htmlWebpackPlugin.options.date.from %> 
            <i class="glyphicon glyphicon-calendar"></i>
          </button>
        </span>
        <input 
            name="startDate" 
            type="text" 
            class="form-control" 
            uib-datepicker-popup="{{format}}" 
            ng-model="startDate" 
            is-open="startDatePopup.opened" 
            datepicker-options="startDateOptions" 
            required="true" 
            close-text="<%= htmlWebpackPlugin.options.general.close %>" 
            current-text="<%= htmlWebpackPlugin.options.date.today %>" 
            clear-text="<%= htmlWebpackPlugin.options.general.clear %>" 
            alt-input-formats="altInputFormats" 
            ng-change="startDateChange()" />
      </p>
      <p class="input-group" style="width: 25%; margin-right: 1rem;">
        <span class="input-group-btn">
          <button 
              type="button" 
              class="btn btn-calendar" 
              ng-click="openEndDate()">
              <%= htmlWebpackPlugin.options.date.to %> 
              <i class="glyphicon glyphicon-calendar"></i>
          </button>
        </span>
        <input 
            name="endDate" 
            type="text" 
            class="form-control" 
            uib-datepicker-popup="{{format}}" 
            ng-model="endDate" 
            is-open="endDatePopup.opened" 
            datepicker-options="endDateOptions" 
            required="true" 
            close-text="<%= htmlWebpackPlugin.options.general.close %>" 
            current-text="<%= htmlWebpackPlugin.options.date.today %>" 
            clear-text="<%= htmlWebpackPlugin.options.general.clear %>" 
            alt-input-formats="altInputFormats" 
            ng-change="endDateChange()" />
      </p>
      <div 
          class="table-filter" 
          ng-if="ready" 
          ng-dropdown-multiselect="" 
          options="availableStatusList" 
          selected-model="statusList" 
          extra-settings="dropdownSettings" 
          events="dropdownEvents" 
          translation-texts="dropdownTranslations">
      </div>
      
      <br>
      <br>
      <br>
      <br>
      
      <div ng-if="ready">
        <table 
            class="table table-striped table-hover" 
            datatable="" 
            dt-options="tableOptions" 
            dt-columns="tableColumns" 
            id="table">
        </table>
      </div>
      <div ng-if="selectedOrderId">
        <legend>
          <%= htmlWebpackPlugin.options.costing.receipts_for %>
        </legend>
        <table class="table table-striped table-hover" id="bills-table">
          <thead>
            <th><%= htmlWebpackPlugin.options.costing.receipt_no %></th>
            <th><%= htmlWebpackPlugin.options.general.cost %></th>
            <th><%= htmlWebpackPlugin.options.general.emission_date %></th>
            <th><%= htmlWebpackPlugin.options.general.download %></th>
            <th ng-if="currentUser.canAdmin">
              <%= htmlWebpackPlugin.options.general.delete %>
            </th>
          </thead>
          <tbody ng-repeat="bill in bills">
            <td>{{bill.folio}}</td>
            <td>{{bill.value | currency}}</td>
            <td>{{bill.date}}</td>
            <td>
              <a 
                  class="btn btn-success" 
                  href="{{bill.downloadLink}}" 
                  download="{{bill.filename}}">
                <%= htmlWebpackPlugin.options.general.download %>
              </a>
            </td>
            <td ng-if="currentUser.canAdmin">
              <button 
                  class="btn btn-danger" 
                  ng-click="deleteBill(bill.id)">
                <%= htmlWebpackPlugin.options.general.delete %>
              </button>
            </td>
          </tbody>
        </table>
      </div>
      <p ng-show="step=='empty'">
        <%= htmlWebpackPlugin.options.general.no_data %>
      </p>
      <p ng-show="step=='loading'">
        <%= htmlWebpackPlugin.options.general.login %>
      </p>
    </div>
  </div>
</div>