<div class="statistics-view">
	<div class="ibox">
		<div class="ibox-title">
			<h3>Estadísticas</h3>
		</div>

		<div class="ibox-content">
			<h3>Configuración</h3>
			<div>
				<form name="filterForm" role="form" novalidate ng-submit="filter(filterForm)" autocomplete="off">
					<p class="input-group pull-left" style="width: 48%; margin-right: 1rem;">
						<span class="input-group-btn">
							<button type="button" class="btn btn-calendar" ng-click="openStartDate()">Desde <i class="glyphicon glyphicon-calendar"></i></button>
						</span>
						<input name="startDate" type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="startDate" is-open="startDatePopup.opened" datepicker-options="startDateOptions" required="true" close-text="Cerrar" current-text="Hoy" clear-text="Limpiar" alt-input-formats="altInputFormats" ng-change="startDateChange()">
						<small class="error-message" ng-if="filterForm.$validated && filterForm.startDate.$error.required">Campo requerido</small>
					</p>

					<p class="input-group pull-right" style="width: 48%; ">
						<span class="input-group-btn">
							<button type="button" class="btn btn-calendar" ng-click="openEndDate()">Hasta <i class="glyphicon glyphicon-calendar"></i></button>
						</span>
						<input name="endDate" type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="endDate" is-open="endDatePopup.opened" datepicker-options="endDateOptions" required="true" close-text="Cerrar" current-text="Hoy" clear-text="Limpiar" alt-input-formats="altInputFormats">
						<small class="error-message" ng-if="filterForm.$validated && filterForm.endDate.$error.required">Campo requerido</small>
					</p>
					<br><br>
					<div class="form-group" style="width: 48%; display: inline-block;">
						<label>Ciudad</label>
						<select name="city" ng-model="city" class="form-control">
							<option value></option>
							<option value="Ensenada">Ensenada</option>
							<option value="Tijuana">Tijuana</option>
							<option value="Mexicali">Mexicali</option>
							<option value="Rosarito">Rosarito</option>
							<option value="Tecate">Tecate</option>
						</select>
						<small class="error-message" ng-if="filterForm.$validated && filterForm.city.$error.required">Campo requerido</small>
					</div>
					<div class="pull-right" style="display: inline-block; margin-bottom: 1rem; margin-top: 35px;">
						<button class="pull-right btn btn-primary-right" type="submit"> Filtrar</button>
						<button class="pull-right btn btn-tertiary-right" type="button" ng-click="clear()"> Limpiar</button>
					</div>
				</form>	
			</div>
			
			
			<div style="width: 85%; margin: 100px auto;" ng-if="salesData.labels.length > 0">
				<legend ng-if="salesData.labels.length > 0">Cotizaciones Tiempo vs Origen</legend>
				<button class="btn btn-default" type="button" ng-click="changeBarChartType('WEEKLY')"> Semanal</button>
				<button class="btn btn-default" type="button" ng-click="changeBarChartType('MONTHLY')"> Mensual</button>
				<br><br>
				<canvas id="bar" class="chart chart-bar" chart-data="salesData.data" chart-labels="salesData.labels" chart-series="salesData.series" chart-colors="colors" chart-options="stackedSalesChartOptions"></canvas>
			</div>

			<div style="width: 85%; margin: 100px auto;" ng-if="productType.labels.length > 0">
				<legend ng-if="productType.labels.length > 0">Cotizaciones por producto</legend>
				<br><br>
				<canvas id="bar" class="chart chart-bar" chart-data="productType.data" chart-labels="productType.labels" chart-series="productType.series" chart-colors="colors" chart-options="stackedProductTypeChartOptions"></canvas>
			</div>
			
			<div style="text-align: center; width: 100%;">
				<div style="width: 33%; float: left;" ng-if="origin.data.length > 0">
					<legend>Origen de cotización</legend>
					<canvas id="doughnut" chart-colors="colors" class="chart chart-doughnut" chart-data="origin.data" chart-labels="origin.labels" chart-options="doughnutOriginChartOptions"></canvas> 
				</div>
				<div style="width: 33%; display: inline-block; margin: 0 auto;" ng-if="status.data.length > 0">
					<legend>Estado</legend>
					<canvas id="doughnut" chart-colors="colors" class="chart chart-doughnut" chart-data="status.data" chart-labels="status.labels" chart-options="doughnutStatusChartOptions"></canvas> 
				</div>
				<div style="width: 33%; float: right;" ng-if="lost.data.length > 0">
					<legend>Motivo Venta Perdida</legend>
					<canvas id="doughnut" chart-colors="colors" class="chart chart-doughnut" chart-data="lost.data" chart-labels="lost.labels" chart-options="doughnutLostChartOptions"></canvas> 
				</div>
			</div>
			<br><br>
			<div ng-if="sellersData.length > 0">
				<legend>Estadística de Asesores</legend>
				<table class="table table-striped  table-hover" id="sellersTable">
					<thead>
						<tr>
							<th rowspan="2">Asesor</th>
							<th colspan="2">NUEVAS</th>
							<th colspan="2">EN SEGUIMIENTO</th>
							<th colspan="2">CERRADAS</th>
							<th colspan="2">PERDIDAS</th>
							<th colspan="2">CANCELADAS</th>
						</tr>
						<tr>
							<th>Cant.</th>
							<th>Valor</th>

							<th>Cant.</th>
							<th>Valor</th>

							<th>Cant.</th>
							<th>Valor</th>

							<th>Cant.</th>
							<th>Valor</th>

							<th>Cant.</th>
							<th>Valor</th>
						</tr>
					</thead>
					<tbody ng-repeat="seller in sellersData">
						<tr>
							<td>{{seller.name}}</td>

							<td>{{seller.nuevas.count}}</td>
							<td>{{seller.nuevas.amount | currency : '$' : 0}}</td>

							<td>{{seller.seguimiento.count}}</td>
							<td>{{seller.seguimiento.amount | currency : '$' : 0}}</td>

							<td>{{seller.cerradas.count}}</td>
							<td>{{seller.cerradas.amount | currency : '$' : 0}}</td>

							<td>{{seller.perdidas.count}}</td>
							<td>{{seller.perdidas.amount | currency : '$' : 0}}</td>

							<td>{{seller.canceladas.count}}</td>
							<td>{{seller.canceladas.amount | currency : '$' : 0}}</td>
						</tr>
					</tbody>
					<tfoot>
						<tr>
							<th>Total</th>
							<td>{{sellersData.totals.nuevas.count}}</td>
							<td>{{sellersData.totals.nuevas.amount | currency : '$' : 0}}</td>

							<td>{{sellersData.totals.seguimiento.count}}</td>
							<td>{{sellersData.totals.seguimiento.amount | currency : '$' : 0}}</td>

							<td>{{sellersData.totals.cerradas.count}}</td>
							<td>{{sellersData.totals.cerradas.amount | currency : '$' : 0}}</td>

							<td>{{sellersData.totals.perdidas.count}}</td>
							<td>{{sellersData.totals.perdidas.amount | currency : '$' : 0}}</td>

							<td>{{sellersData.totals.canceladas.count}}</td>
							<td>{{sellersData.totals.canceladas.amount | currency : '$' : 0}}</td>
						</tr>
					</tfoot>
				</table>
			</div>

			<div ng-if="efficiencyData.length > 0">
				<legend>Efectividad de Asesores</legend>
				<table class="table table-striped  table-hover" id="efficiencyTable">
					<thead>
						<tr>
							<th rowspan="2">Asesor</th>
							<th colspan="3">Tienda</th>
							<th colspan="3">Facebook</th>
							<th colspan="3">Prospección</th>
							<th colspan="3">Cliente</th>
							<th colspan="3">Recomendación</th>
						</tr>
						<tr>
							<th>Total</th>
							<th>Cerr</th>
							<th>Effect</th>

							<th>Total</th>
							<th>Cerr</th>
							<th>Effect</th>

							<th>Total</th>
							<th>Cerr</th>
							<th>Effect</th>

							<th>Total</th>
							<th>Cerr</th>
							<th>Effect</th>

							<th>Total</th>
							<th>Cerr</th>
							<th>Effect</th>
						</tr>
					</thead>
					<tbody ng-repeat="seller in efficiencyData">
						<tr>
							<td>{{seller.name}}</td>

							<td>{{seller.tienda.total}}</td>
							<td>{{seller.tienda.closed}}</td>
							<td>{{seller.tienda.efficiency | number : 0}}%</td>

							<td>{{seller.facebook.total}}</td>
							<td>{{seller.facebook.closed}}</td>
							<td>{{seller.facebook.efficiency | number : 0}}%</td>

							<td>{{seller.prospeccion.total}}</td>
							<td>{{seller.prospeccion.closed}}</td>
							<td>{{seller.prospeccion.efficiency | number : 0}}%</td>

							<td>{{seller.cliente.total}}</td>
							<td>{{seller.cliente.closed}}</td>
							<td>{{seller.cliente.efficiency | number : 0}}%</td>

							<td>{{seller.recomendacion.total}}</td>
							<td>{{seller.recomendacion.closed}}</td>
							<td>{{seller.recomendacion.efficiency | number : 0}}%</td>
						</tr>
					</tbody>
					<tfoot>
						<tr>
							<th>Total</th>
							<td>{{efficiencyData.totals.tienda.count}}</td>
							<td>{{efficiencyData.totals.tienda.amount}}</td>
							<td>-</td>

							<td>{{efficiencyData.totals.facebook.count}}</td>
							<td>{{efficiencyData.totals.facebook.amount}}</td>
							<td>-</td>

							<td>{{efficiencyData.totals.prospeccion.count}}</td>
							<td>{{efficiencyData.totals.prospeccion.amount}}</td>
							<td>-</td>

							<td>{{efficiencyData.totals.cliente.count}}</td>
							<td>{{efficiencyData.totals.cliente.amount}}</td>
							<td>-</td>

							<td>{{efficiencyData.totals.recomendacion.count}}</td>
							<td>{{efficiencyData.totals.recomendacion.amount}}</td>
							<td>-</td>
						</tr>
					</tfoot>
				</table>
			</div>

		</div>
	</div>
</div>